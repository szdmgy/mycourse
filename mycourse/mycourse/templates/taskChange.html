<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>作业编辑</title>
    {% load static %}
    <link href="{% static 'css/teacherTasks.css' %}" rel="stylesheet"/>

    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <!-- bootstrap.bundle.min.js 用于弹窗、提示、下拉菜单，包含了 popper.min.js -->
    <script src="{% static 'js/popper.min.js' %}"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    {# 为全选、全不选、下载作业绑定事件  #}
    <script type="text/javascript" src="{% static 'js/teacherTasks.js' %}"></script>
<style>
        .form-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 2rem;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .readonly-field {
            background-color: #f8f9fa;
            pointer-events: none; /* 禁止编辑 */
        }
        .editable-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #dee2e6;
        }
    </style>

</head>
<body>
<div class="container">
     <!-- 欢迎语句和注销 -->
    <div class="jumbotron ">
        <h1>{{ name }}</h1>
        <a href="{% url 'logout' %}" id="logout"> 注销</a>
        <a href="{% url 'teacherCourseChange' course.courseTerm course.courseName course.classNumber %}" id="courseList-a"> 返回课程信息 </a>
    </div>
    <div class="courseList-div well">
     <div class="form-container">
        <h2 class="mb-4">编辑作业</h2>

        <!-- 不可修改的基础信息 -->
        <div class="mb-4">
            <h5>基础信息（不可修改）</h5>
            <div class="mb-3">
                <label class="form-label">作业标题</label>
                <input type="text" class="form-control readonly-field" value="{{ task.title }}" readonly>
            </div>
            <div class="mb-3">
                <label class="form-label">作业正文</label>
                <textarea class="form-control readonly-field" rows="3" readonly>{{ task.content }}</textarea>
            </div>
            <!-- 所属课程（原字段） -->
            <div class="mb-3">
                <label class="form-label">所属课程</label>
                <input type="text" class="form-control readonly-field" value="{{ task.courseBelongTo  }}" readonly>
            </div>
            <!-- 新增：上传类型（显示在所属课程后，不可修改） -->
            <div class="mb-3">
                <label class="form-label">允许上传的文件类型</label>
                <input type="text"
                       class="form-control readonly-field"
                       value="{{ task.uploadFileType|default:'*' }}">  <!-- 默认值兼容空数据 -->

            </div>
        </div>

        <!-- 可修改的字段（显示在靠后位置） -->
        <div class="editable-section">
            <form id="taskForm" method="post">
                {% csrf_token %}

                <!-- 是否显示开关 -->
                <div class="mb-3">
                    <label for="id_display" class="form-label">是否显示 <span class="text-danger">*</span></label>
                    <div class="form-check">
                        <input type="checkbox"
                               class="form-check-input"
                               id="id_display"
                               name="display"
                               {% if task.display == True %}checked{% endif %}>
                        <label class="form-check-label" for="id_display">
                            {{ "是否显示" }}
                        </label>
                    </div>
                    <div class="invalid-feedback">请选择是否显示。</div>
                </div>

                <!-- 截止日期选择（允许早于今日） -->
                <div class="mb-4">
                    <label for="id_deadline" class="form-label">截止日期 <span class="text-danger">*</span></label>
                    <input type="date"
                           class="form-control"
                           id="id_deadline"
                           name="deadline"
                           value="{{ task.deadline|date:'Y-m-d' }}"
                           required>
                    <div class="form-text">截止日期可为任意历史或未来日期。</div>
                    <div class="invalid-feedback">请选择有效的截止日期。</div>
                </div>

                <!-- 提交按钮 -->
                <button type="submit" class="btn btn-primary">保存修改</button>
                <button type="button" class="btn btn-secondary ms-2" onclick="window.history.back()">取消</button>
            </form>
        </div>
    </div>
    </div>
</div>
</body>
</html>