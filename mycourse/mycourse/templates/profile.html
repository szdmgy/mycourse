{% extends "base.html" %}
{% block title %}个人资料 - 实验报告收集系统{% endblock %}
{% block nav_profile %}active{% endblock %}

{% block extra_css %}
<style>
  .profile-container { max-width: 580px; margin: 0 auto; }
  .form-section { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
  .readonly-field { color: #555; background: #f8f9fa; padding: 6px 12px; border-radius: 4px; display: inline-block; }
</style>
{% endblock %}

{% block content %}
<div class="profile-container">
  <h2 class="mb-4 text-center">编辑个人资料</h2>

  {% if ok %}
    <div class="alert alert-success"><i class="bi bi-check-circle"></i> 个人信息修改成功！</div>
  {% endif %}

  <div class="card p-4">
    <form method="post" novalidate>
      {% csrf_token %}

      <div class="form-section">
        <h3>基础信息</h3>
        <div class="mb-3">
          <label class="form-label">{% if profile.type == 'T' %}工号{% else %}学号{% endif %}</label>
          <span class="readonly-field">{{ profile.user.username }}</span>
        </div>
        <div class="mb-3">
          <label class="form-label">姓名</label>
          {{ form.name }}
          {% if form.name.errors %}<div class="text-danger">{{ form.name.errors.0 }}</div>{% endif %}
        </div>
      </div>

      <div class="form-section">
        <h3>身份信息</h3>
        <div class="mb-3">
          <label class="form-label">性别</label>
          <span class="readonly-field">{{ profile.get_gender_display }}</span>
        </div>
      </div>

      <div class="form-section">
        <h3>联系方式</h3>
        <div class="mb-3">
          <label for="{{ form.email.id_for_label }}" class="form-label">邮箱</label>
          {{ form.email }}
          {% if form.email.errors %}<div class="text-danger">{{ form.email.errors.0 }}</div>{% endif %}
        </div>
        <div class="mb-3">
          <label for="{{ form.phone.id_for_label }}" class="form-label">手机号</label>
          {{ form.phone }}
          {% if form.phone.errors %}<div class="text-danger">{{ form.phone.errors.0 }}</div>{% endif %}
        </div>
      </div>

      <button type="submit" class="btn btn-primary w-100">
        <i class="bi bi-save"></i> 保存修改
      </button>
    </form>

    <div class="text-center mt-3">
      <a href="{% url 'change_password' %}" class="text-decoration-none">
        <i class="bi bi-key"></i> 修改登录密码
      </a>
    </div>
  </div>
</div>
{% endblock %}
