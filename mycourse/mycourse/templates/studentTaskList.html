{% extends "base.html" %}
{% load static %}
{% block title %}{{ course.courseName }} - 作业列表{% endblock %}
{% block nav_stu_courses %}active{% endblock %}

{% block content %}
<nav aria-label="breadcrumb" class="mb-3">
  <ol class="breadcrumb" style="font-size:.85rem;">
    <li class="breadcrumb-item"><a href="{% url 'studentCourseList' %}">我的课程</a></li>
    <li class="breadcrumb-item active">{{ course.courseName }}（{{ course.classNumber }}班）</li>
  </ol>
</nav>

<div class="card mb-3">
  <div class="card-body py-2">
    <div class="row" style="font-size:.85rem; color:#555;">
      <div class="col-md-3"><strong>学期：</strong>{{ course.courseTerm }}</div>
      <div class="col-md-3"><strong>课程编号：</strong>{{ course.courseNumber }}</div>
      <div class="col-md-3"><strong>班号：</strong>{{ course.classNumber }}</div>
      <div class="col-md-3"><strong>教师：</strong>{{ course.teachers }}</div>
    </div>
  </div>
</div>

<h2 class="mb-3"><i class="bi bi-list-task"></i> 作业列表</h2>

{% if taskRecords %}
<div class="table-responsive">
  <table class="table table-hover align-middle">
    <thead class="table-light">
      <tr>
        <th style="width:40px;">#</th>
        <th>作业名称</th>
        <th>截止日期</th>
        <th>提交状态</th>
        <th>提交时间</th>
        <th style="width:120px;">操作</th>
      </tr>
    </thead>
    <tbody>
      {% for r in taskRecords %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td><strong>{{ r.title }}</strong></td>
        <td>{{ r.deadline|date:"Y-m-d" }}</td>
        <td>
          {% if r.status == 'submitted' %}
            <span class="badge badge-submitted"><i class="bi bi-check-circle"></i> {{ r.status_text }}</span>
          {% elif r.status == 'pending' %}
            <span class="badge badge-pending"><i class="bi bi-clock"></i> {{ r.status_text }}</span>
          {% elif r.status == 'delay_submitted' %}
            <span class="badge badge-delay"><i class="bi bi-exclamation-triangle"></i> {{ r.status_text }}</span>
          {% elif r.status == 'overdue' %}
            <span class="badge badge-overdue"><i class="bi bi-x-circle"></i> {{ r.status_text }}</span>
          {% endif %}
        </td>
        <td>
          {% if r.time %}
            {{ r.time|date:"Y-m-d H:i" }}
          {% else %}
            <span style="color:#999;">—</span>
          {% endif %}
        </td>
        <td>
          <a href="{% url 'taskSubmit' r.id r.title %}" class="btn btn-primary btn-sm">
            <i class="bi bi-upload"></i> 提交
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
  <div class="card p-4 text-center">
    <p style="color:#666;"><i class="bi bi-info-circle"></i> 本课程暂无作业</p>
  </div>
{% endif %}
{% endblock %}
